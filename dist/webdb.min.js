/*! [webdb 0.2.0](http://download.github.io/webdb) Copyright 2015 by [Stijn de Witt](http://StijnDeWitt.com). Some rights reserved. License: [CC-BY-4.0](https://creativecommons.org/licenses/by/4.0/) */
!function(u,m,d){"function"==typeof define&&define.amd?define("webdb",["memorystorage"],function(a){return d(a)}):"object"==typeof exports?module.exports=d(require("memorystorage")):u[m]=d(u.MemoryStorage)}(this,"WebDB",function(a){"use strict";function WebDB(a,b){function c(a,b){if(f[a]=g,b)for(var c in b)f[a][c]=b[c]}var e={},f={},j=!1;if(a=a||"default",h[a])return h[a];if(!(this instanceof WebDB))return new WebDB(a,b);var k=h[a]=this;return Object.defineProperty(k,"name",{value:a}),Object.defineProperty(k,"synching",{value:j}),Object.defineProperty(k,"createTable",{enumerable:!1,get:function(){return function(a,b){if(e[a])throw new Error("A table named `"+a+"` already exists. Use alterTable() to change it's definition, or dropTable() to remove it.");var g=e[a]=new i(a,b);return c(a,b),Object.defineProperty(g,"db",{value:k}),Object.defineProperty(g,"definition",{value:f[a]}),Object.defineProperty(k,a,{configurable:!0,enumerable:!0,writable:!1,value:e[a]}),g}}}),Object.defineProperty(k,"alterTable",{enumerable:!1,get:function(){return function(a,b){if(!e[a])throw new Error("No table named `"+a+"` exists. Use createTable() to create it.");return c(a,b),e[a]}}}),Object.defineProperty(k,"dropTable",{enumerable:!1,get:function(){return function(a){e[a]||window.console&&console.warn&&console.warn("Call to dropTable() is ignored.",new Error("No table named `"+a+"` exists.")),delete k[a],delete e[a],delete f[a]}}}),k}function b(a,c,e){if("length"in a){for(var f,g=[],h=0;f=a[h];h++)g.push.apply(g,b(f,c,e));return g}return e.call(c,a)}function c(a,b,c){return a==b||c&&0===c(a,b)||a&&a.equals&&a.equals(b)||b&&b.equals&&b.equals(a)||"object"==typeof a&&a&&a.valueOf()==b||"object"==typeof b&&b&&b.valueOf()==a}function e(a,b,e){for(var f,g=0;f=a[g];g++)if(c(f,b,e))return g;return-1}function f(a,b){var f=Array.prototype.concat.call(a||[]);if(b)for(var g=f.length-1;g>=0;g--)for(var h in b)if(b.hasOwnProperty(h))if(Array.isArray&&Array.isArray(b[h])||b[h]instanceof Array){if(-1===e(b[h],a[g][h])){f.splice(g,1);break}}else if(!c(a[g][h],b[h])){f.splice(g,1);break}return f}var g={columns:{id:{type:Number},version:{type:Number}},primaryKey:"id",version:"version",foreignKeys:{},uniqueKeys:{},constraints:{},indexes:{},entityType:Object},h={},i=WebDB.Table=function j(a,c){if(!(this instanceof j))return new j(a,c);Object.defineProperty(this,"name",{value:a});var g=[],h=[],i=[],k=[],l=[],n=[],o=[],p=null;Object.defineProperty(this,"created",{get:function(){return h.concat()}}),Object.defineProperty(this,"updated",{get:function(){return i.concat()}}),Object.defineProperty(this,"deleted",{get:function(){return k.concat()}}),Object.defineProperty(this,"stale",{get:function(){return l.concat()}}),Object.defineProperty(this,"future",{get:function(){return n.concat()}}),Object.defineProperty(this,"failed",{get:function(){return o.concat()}}),Object.defineProperty(this,"failure",{value:p}),Object.defineProperty(this,"get",{get:function(){return function(a){return f(g,a)}}}),Object.defineProperty(this,"set",{get:function(){return function(){var a=b(arguments,this,function(a){var b,c=null;return b=e(g,a),-1===b?g.push(a):c=g.splice(b,1,a)[0],b=e(k,a),-1!==b&&(c=k.splice(b,1)),this.persistent(a)?(b=e(i,a),-1===b?i.push(c):this.db.synching&&(b=e(n,a),-1===b?n.push(a):n.splice(b,1,a))):(b=e(h,a),-1===b&&h.push(a),b=e(k,a),-1!==b&&k.splice(b,1)),[a]});return a}}}),Object.defineProperty(this,"del",{get:function(){return function(){var a=b(arguments,this,function(a){var b,c=e(g,a);-1!==c&&(b=g.splice(c,1)[0]);var f=e(h,a);if(-1===f){if(c=e(i,a),-1!==c){var j=i.splice(c,1);b=b||j}c=e(n,a),-1!==c&&n.splice(c,1),c=e(k,a),-1===c&&k.push(b||a)}return[b||a]});return a}}})};return i.prototype.persistent=function(a){return null!==a[this.definition.version]&&void 0!==a[this.definition.version]},i.prototype.toJSON=function(){},i.fromJSON=function(){},WebDB});
//# sourceMappingURL=webdb.min.js.map